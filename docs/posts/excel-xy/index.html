<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Juan Riera">
<meta name="dcterms.date" content="2023-01-28">

<title>Blog de Juan Riera - Cómo hacer gráficos XY en Microsoft Excel a partir de datos arreglados (tidy)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Blog de Juan Riera</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">Juan Riera</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/juanriera/"><i class="bi bi-linkedin" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/juanriera/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/@rieraprieto/"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://mstdn.social/@juanriera/"><i class="bi bi-mastodon" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Cómo hacer gráficos XY en Microsoft Excel a partir de datos arreglados (<em>tidy</em>)</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Juan Riera </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 28, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>En el mundo de la empresa, la utilización de las hojas de cálculo, sobre todo de Microsoft Excel, está mucho más extendida que la de lenguajes como R o python, y por eso siempre que enseño métodos de análisis de datos en R, intento presentar de forma simultánea cómo se realizarían en Excel, si es posible; comparando ventajas e inconvenientes de ambas herramientas. Así, aquellas personas que no están formadas en R, pero sí tienen experiencia en Excel, pueden imaginar un camino de aprendizaje hacia la nueva herramienta, o simplemente adoptar la técnica con la hoja de cálculo conocida.</p>
<p>Una de las cosas que siempre he echado de menos en Excel, y que es muy fácil en R o python, es la posibilidad de hacer gráficos XY segmentados por una columna adicional que se utiliza para codificar en color de acuerdo con los valores de esa columna. Con <code>ggplot</code> en R, es inmediato utilizar <code>colour</code> para las categorías:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Width, <span class="at">colour =</span> Species)) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Si queremos evitar el solapamiento de puntos en los valores repetidos, podemos usar la geometría <code>geom_jitter()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span> (ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Width, <span class="at">colour =</span> Species)) <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">stroke =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>El inconveniente de este gráfico en Excel es que para asignar diferentes colores a las series, Excel necesita que las series estén separadas en diferentes columnas. Esto es debido probablemente a que el diseño de Excel es muy anterior a los conceptos modernos de datos arreglados (<em>tidy data</em>) y a los modernos programas de análisis de datos como R, python, o incluso el propio Power BI de Microsoft.</p>
<p>He encontrado algunas soluciones creativas a este problema, entre ellas la de <a href="http://daydreamingnumbers.com/about/">Vidya</a> en su blog <a href="http://daydreamingnumbers.com/">Daydreaming Numbers</a>. <a href="http://daydreamingnumbers.com/how-to/conditional-colouring-to-scatterplots-in-excel/">La solución que ella propone</a> es la creación de las columnas necesarias con los campos de clasificación, y mediante fórmulas condicionales, recolocar los valores en estas nuevas columnas. Sin embargo, aunque la solución funciona, no cumple con mi requerimiento de respetar el formato de datos arreglados (<em>tidy</em>), y no es compatible con el uso avanzado de tablas en Excel y en Power Pilot / Power BI.</p>
<p>La solución que yo estoy buscando debe llegar a través de métodos que no alteren la estructura de los datos originales, y sean compatibles con las nuevas herramientas como Power Pivot, Power BI, o lenguajes como R o python. Esto exige no modificar la estructura de la tabla de datos original, o en todo caso, hacerlo respetando los datos originales y la estructura original.</p>
<p>El método que he elegido es utilizar las tablas dinámicas. Desgraciadamente (e inexplicablemente), las tablas dinámicas no permiten la utilización de gráficos dinámicos XY, por lo que los usuarios han buscado formas alternativas de crearlos. La que vamos a utilizar aquí es la creación de un gráfico XY a partir de la asignación manual de los rangos de datos de la tabla dinámica. Es un proceso algo largo, pero no es complicado.</p>
<p>Utilizaremos el dataset <code>iris</code>(<a href="https://es.wikipedia.org/wiki/Conjunto_de_datos_flor_iris">Conjunto de datos Iris en Wikipedia</a>, <a href="https://www.kaggle.com/datasets/uciml/iris">Conjunto de datos Iris en kaggle</a>), exportado desde R, que convertimos en una tabla de Excel mediante <code>Menu</code>&gt;<code>Insertar</code>&gt;<code>Tabla</code></p>
<p><img src="excel-tabla-iris.png" class="img-fluid"></p>
<p>Queremos hacer una gráfica XY de la columna <code>Sepal.Length</code> frente a <code>Petal.Width</code>. Comenzamos insertando una tabla dinámica a partir de esta tabla, y colocamos<code>Species</code>en columnas,<code>Sepal.Length</code>en filas y<code>Petal.Width</code>en valores.</p>
<p>Vamos a introducir algunas opciones de diseño de la tabla dinámica que nos facilitan el trabajo de construcción del gráfico. Haciendo <em>click</em> derecho en cualquier parte de la tabla, seleccionamos <code>Opciones de la tabla dinámica</code>. En la pestaña <code>Diseño y formato</code>, deseleccionamos la opción <code>Autoajustar anchos de columnas al actualizar</code>(de forma que quitemos la marca de <em>check</em>). En la pestaña <code>Totales y filtros</code>, deseleccionamos las dos opciones de <code>Totales generales</code>, de manera que quitemos la marca de <code>Mostrar totales generales de filas</code>y de <code>Mostrar totales generales de las columnas</code>.</p>
<p><img src="excel-td-recuento.png" class="img-fluid"></p>
<p>Excel siempre utiliza fórmulas de agrupación en los campos de valores, y por defecto utiliza <code>Recuento</code>. La fórmula de <code>Recuento</code> nos permite ver que hay algunas parejas de valores que están repetidas, por ejemplo, hay 8 valores de <code>Petal.Width</code>que coinciden con un valor de 5 en <code>Sepal.Length</code> y que la tabla dinámica ha agrupado. Esto es un inconveniente porque en un gráfico XY queremos que nos aparezcan todos los pares de valores sin agrupar, para que la nube de puntos represente el total de los datos.</p>
<p>Por el momento vamos a explorar hasta dónde nos permite llegar la tabla dinámica con sus opciones de formato ordinarias. Para representar valores de <code>Petal.Width</code>, reemplazamos la fórmula de <code>Recuento</code>por la de <code>Promedio</code>. Para ello hacemos <code>click-derecho</code> sobre uno de los campos de valor en la tabla, y seleccionamos <code>Resumir valores...</code> y a continuación, <code>Promedio</code>.</p>
<p><img src="excel-td-promedio.png" class="img-fluid"></p>
<p>Esta tabla ya nos permite representar pares de valores. Como hemos visto, si intentamos insertar un gráfico dinámico XY, Excel nos devuelve un mensaje advirtiendo que no es posible presentar este gráfico.</p>
<p><img src="excel-mensaje-xy.png" class="img-fluid"></p>
<p>El único gráfico de puntos que podríamos insertar como gráfico dinámico es un gráfico de líneas y puntos al que podríamos borrar las líneas, pero no es lo que buscamos, porque presenta los valores X como secuencia, y no como valores numéricos en una escala.</p>
<p><img src="excel-graf-dinamico.png" class="img-fluid"></p>
<p>Para conseguir un gráfico XY real, empezamos insertando un gráfico XY en blanco a la derecha de la tabla dinámica. Para ello, colocamos el cursor dos columnas a la derecha de la tabla dinámica e insertamos un nuevo gráfico XY, que nos aparecerá como un marco en blanco, ya que no hemos establecido ningún rango de datos. Esto es lo que haremos a continuación.</p>
<p><img src="excel-crear-series-0.png" class="img-fluid"></p>
<p>Haciendo <em>click</em> derecho sobre el marco vacío del gráfico, seleccionamos la opción <code>Seleccionar datos...</code>. Ahora vamos a ir agregando nuestras seres manualmente. Hacemos <em>click</em> en <code>Agregar</code></p>
<p><img src="excel-crear-series-1.png" class="img-fluid"></p>
<p>Excel nos abre la ventana de selección de los datos de las series.</p>
<p><img src="excel-crear-series-2.png" class="img-fluid"></p>
<ul>
<li>Pinchamos en la flecha de selección a la derecha de nombre de la serie; para buscar el nombre, vamos a seleccionar el valor en el encabezado de la tabla dinámica en la que tenemos el nombre de la primera serie, <code>setosa</code> (en mi caso es la celda <code>B4</code>).</li>
<li>Seleccionamos los <code>valores X de la serie</code> eligiendo los valores de las filas (columna <code>A</code>) <strong>poniendo mucha atención a no seleccionar el encabezado</strong>, sólo los valores numéricos. Necesitamos <strong>engañar</strong> a Excel para que no sepa que estamos usando los datos de la tabla dinámica, porque en ese caso, volverá a enviarnos el mensaje de error.</li>
<li>Seleccionamos los <code>Valores Y de la serie</code> seleccionando todos los valores de la columna de la serie <code>setosa</code>, <strong>sin seleccionar el encabezado de la tabla dinámica</strong> y seleccionando <strong>toda la columna desde la primera celda de datos hasta la última, incluyendo los valores en blanco</strong></li>
</ul>
<p><img src="excel-crear-series-3.png" class="img-fluid"></p>
<p>Verificamos que los valores X y los valores Y de la serie tengan la misma longitud de rango (en este caso, desde la fila 1 hasta la 39). Una vez rellenada la serie, seleccionamos <code>Aceptar</code></p>
<p>Repetimos el proceso para las otras dos series, seleccionando el nombre de variable, el rango X (<strong>hay que reintroducirlo cada vez en cada serie</strong>), y el rango Y. Si todo ha ido bien, deberíamos tener nuestra primera versión del gráfico</p>
<p><img src="excel-crear-series-4.png" class="img-fluid"></p>
<p>Ajustamos la escala del eje X para un mínimo de 4, añadimos rótulos de ejes y leyenda</p>
<p><img src="excel-crear-series-6.png" class="img-fluid"></p>
<p>Este es un gráfico XY verdadero, en el que los valores del eje X y del eje Y son valores numéricos. Es un gráfico que puede ser útil en algunas circunstancias, nos simplifica la representación gracias a que la fórmula <code>Promedio</code>nos reduce a un punto todos los valores de Y que se corresponden con un valor determinado de X. Esto nos permite visualizar claramente las diferencias entre las tres poblaciones que estamos representando. Sin embargo, no es un verdadero gráfico XY porque no hemos representado todos los pares de valores.</p>
<p>La forma de construir el gráfico que buscamos es, de nuevo, engañar a Excel, haciendo que cada valor de X y cada valor de Y sea diferente. Así Excel no podrá agruparlos, y la fórmula de resumen <code>Promedio</code> nos devolverá en realidad el promedio de un solo valor en cada celda de la tabla dinámica. Esto no es un problema para Excel, porque simplemente utiliza 1 como divisor del promedio.</p>
<p>Para conseguir nuestro objetivo, tenemos que volver a la tabla original y crear dos nuevas columnas, que se corresponderán con el eje X y el eje Y. Calcularemos los nuevos valores mediante una fórmula que sume un valor aleatorio suficientemente largo al valor original como para que la probabilidad de que coincidan dos valores sea casi cero. Para evitar modificar el valor original, dividimos el valor aleatorio por un exponente de 10 tal que la serie de decimales que obtenemos esté siempre por detrás del último valor decimal de la serie original. Por ejemplo, si nuestros valores tienen un decimal, dividimos el valor aleatorio entre 100. Las fórmulas que utilizo son <code>=[@[Sepal.Length]]+ALEATORIO()/100</code>y <code>=[@[Petal.Width]]+ALEATORIO()/100</code>. Este método tiene un efecto semejante a la utilización de <code>jitter</code>en <code>ggplot</code>.</p>
<p>Esta es la tabla modificada:</p>
<p><img src="excel-tabla-iris-modif.png" class="img-fluid"></p>
<p>Insertamos una nueva tabla dinámica a partir de esta tabla, utilizando en filas y en valores las nuevas variables calculadas; verificamos mediante la fórmula <code>Recuento</code> que ahora ya no hay valores acumulados, cada pareja de valores es única.</p>
<p><img src="excel-td-2-recuento.png" class="img-fluid"></p>
<p>Sustituimos la fórmula <code>Recuento</code>por la fórmula <code>Promedio</code>y repetimos todo el proceso que hemos hecho anteriormente:</p>
<ul>
<li>Con el cursor en una celda en blanco fuera de la tabla dinámica y a la derecha, insertamos gráfico XY en blanco,</li>
<li>Añadimos las series una a una tal como hemos hecho antes</li>
<li>Añadimos rótulos de ejes y gráfico, y otros detalles y retoques que creamos oportunos</li>
</ul>
<p>Este es mi gráfico XY final en Excel, que se puede comparar con el que hace <code>ggplot</code>.</p>
<p><img src="excel-graf-XY-final.png" class="img-fluid"></p>
<p>Y este es el gráfico en <code>ggplot</code>, que vimos al principio del artículo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span> (ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Width, <span class="at">colour =</span> Species)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">stroke =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En Excel, jugando con el factor de multiplicación en las fórmulas de las columnas calculadas, podemos aumentar el efecto de <code>jitter</code> en caso de que el solapamiento sea excesivo. Al recalcular la tabla dinámica podremos ver el efecto producido y decidir si es bajo, excesivo, o es el que queremos.</p>
<p>El gráfico XY en Excel es mucho más largo de hacer que en <code>ggplot</code>, pero es perfectamente realizable, como hemos visto. Tiene la ventaja de la gran facilidad de edición de la hoja de cálculo, que permite un grado de personalización casi ilimitado. Como inconveniente, citar que el uso de estas opciones de personalización no se presentan en forma de código y por lo tanto no siempre son fáciles de reproducir por otras personas. Esa es una de la grandes ventajas del código R: la reproducibilidad de los informes, y una de las razones para promover su utilización no sólo en el mundo de la investigación y la Universidad, sino en la empresa en general.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>